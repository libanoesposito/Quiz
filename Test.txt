√â qui?

async function renderAdminPanel() {
    localStorage.setItem('currentSection', 'admin');
    updateNav(true, "showHome()");
    document.getElementById('app-title').innerText = "ADMIN";
    
    document.getElementById('content-area').innerHTML = `
        <div style="text-align:center; padding:50px; opacity:0.6">
            <div class="spinner" style="margin-bottom:10px">üîÑ</div>
            Sincronizzazione database globale...
        </div>`;

    try {
        const snapshot = await db.collection("utenti").get();
        snapshot.forEach(doc => { dbUsers[doc.id] = doc.data(); });

        const users = Object.entries(dbUsers)
            .filter(([_, u]) => u.userId)
            .map(([pin, u]) => ({
                pin,
                id: u.userId,
                name: u.name,
                stats: calcUserStats(u),
                deleted: u.deleted
            }))
            .sort((a, b) => b.stats.perc - a.stats.perc);

        let html = `<div style="width:100%">`;

        // 1. NUOVO BLOCCO MANUTENZIONE A 3 TASTI
        html += `
            <div class="review-card" style="margin-bottom:20px; border-left: 4px solid #ff3b30">
                <strong style="color:#ff3b30; display:block; margin-bottom:10px">Manutenzione Database Cloud</strong>
                <div style="display:flex; justify-content:space-around; align-items:center; background: rgba(0,0,0,0.05); padding:10px; border-radius:8px">
                    
                    <div style="text-align:center; cursor:pointer" onclick="adminResetAll('FULL')" title="Elimina tutto">
                        <div style="font-size:22px">üíÄ</div>
                        <div style="font-size:10px; font-weight:700">TABULA RASA</div>
                    </div>

                    <div style="text-align:center; cursor:pointer" onclick="adminResetAll('STATS')" title="Azzera punti a tutti">
                        <div style="font-size:22px">üßπ</div>
                        <div style="font-size:10px; font-weight:700">RESET PUNTI</div>
                    </div>

                    <div style="text-align:center; cursor:pointer" onclick="alert('Usa l icona üßº accanto all utente per il reset mirato')">
                        <div style="font-size:22px">üéØ</div>
                        <div style="font-size:10px; font-weight:700">MIRATO</div>
                    </div>
                </div>
            </div>`;

        const attivi = users.filter(u => !u.deleted);
        const eliminati = users.filter(u => u.deleted);

        // Rendering Utenti
        if (attivi.length === 0) {
            html += `<div style="text-align:center; padding:20px; color:#666">Nessun utente nel cloud</div>`;
        } else {
            attivi.forEach(u => {
                const statsText = u.stats.total ? `${u.stats.correct}/${u.stats.total} corrette ¬∑ ${u.stats.perc}%` : "Nessun progresso";
                html += `
                    <div class="review-card is-ok">
                        <div style="display:flex; justify-content:space-between; align-items:center">
                            <div>
                                <strong>${u.name}</strong>
                                <div style="font-size:12px; opacity:0.6">ID ${u.id} - PIN ${u.pin}</div>
                            </div>
                            <div style="display:flex; gap:18px; font-size:18px">
                                <span style="cursor:pointer" title="Storico" onclick="showUserHistory(${u.id})">‚è≥</span>
                                <span style="cursor:pointer" title="Aggiorna" onclick="recalcUser(${u.id})">üîÑ</span>
                                <span style="cursor:pointer" title="Reset Mirato" onclick="adminResetSingleUser(${u.id})">üßº</span>
                                <span style="cursor:pointer; color:#ff3b30" title="Elimina" onclick="adminDeleteUser(${u.id})">üóë</span>
                            </div>
                        </div>
                        <div style="margin-top:8px; font-size:13px">${statsText}</div>
                    </div>`;
            });
        }

        // Sezione Eliminati (Resto del codice uguale...)
        if (eliminati.length > 0) {
            html += `
                <div class="glass-card" style="margin-top:30px; border:1px solid rgba(255,59,48,0.2)">
                    <div onclick="const el = document.getElementById('deleted-list'); el.style.display = el.style.display === 'none' ? 'block' : 'none'" 
                         style="cursor:pointer; display:flex; justify-content:center; align-items:center">
                        <strong style="color:#ff3b30; font-size:12px; letter-spacing:1px">UTENTI ELIMINATI (${eliminati.length})</strong>
                    </div>
                    <div id="deleted-list" style="display:none; margin-top:15px">`;
            
            eliminati.forEach(u => {
                html += `
                    <div style="padding:12px 0; border-bottom:1px solid rgba(0,0,0,0.05); display:flex; justify-content:space-between; align-items:center">
                        <div>
                            <span style="font-weight:600">${u.name}</span>
                            <div style="font-size:11px; opacity:0.5">ID ${u.id}</div>
                        </div>
                        <div style="cursor:pointer; color:#0a84ff; font-weight:600; font-size:13px" onclick="showUserHistory(${u.id})">
                            VEDI STORICO
                        </div>
                    </div>`;
            });
            html += `</div></div>`;
        }

        html += `</div>`;
        document.getElementById('content-area').innerHTML = html;

    } catch (error) {
        console.error("Errore:", error);
        document.getElementById('content-area').innerHTML = `<div style="color:red; text-align:center">Errore Cloud.</div>`;
    }
}

Genera esattamente questo allora
